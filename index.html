<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>スタンプカード React版</title>

    <!-- React & Babel（UMD） -->
    <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>

    <!-- PWA（そのまま） -->
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="icon" href="icon-192.png" sizes="192x192" />
    <link rel="apple-touch-icon" href="icon-512.png" sizes="512x512" />
    <meta name="theme-color" content="#10b981" />

    <!-- Tailwind依存を排除。必要最低限のCSSを内蔵 -->
    <style>
      :root{
        --fg:#0f172a; --fg-muted:#475569; --acc:#059669;
        --card:#ffffffcc; --chip:#ffffffbf; /* 白+透過 */
        --ring:#f59e0b;
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{
        margin:0; font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN",Meiryo,Arial,sans-serif;
        background: radial-gradient(1200px 480px at 70% 110%, #b6f0cf 0%, #a3e9c5 35%, rgba(163,233,197,0) 70%),
                    linear-gradient(#eaf6ff 0%, #e9f7ff 35%, #e7fbf3 100%);
        color:var(--fg);
        -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      }
      #root{min-height:100vh}
      #loading-text{position:absolute;top:8px;left:12px;font-size:14px;color:#374151}

      /* レイアウトユーティリティ */
      .container{max-width:1000px;margin:0 auto;padding:0 16px}
      .row{display:flex;align-items:center}
      .gap8{gap:8px} .gap12{gap:12px}
      .muted{color:var(--fg-muted)}
      .btn{height:36px;padding:0 12px;border:1px solid #d1d5db;border-radius:12px;background:var(--chip);color:var(--fg);cursor:pointer}
      .btn.primary{background:var(--acc);color:#fff;border-color:#0f766e}
      .btn:disabled{opacity:.6;cursor:not-allowed}

      header.sticky{position:sticky;top:0;z-index:20;background:#ffffffb3;border-bottom:1px solid #e5e7eb;backdrop-filter:blur(6px)}
      header .title{font-weight:700;font-size:18px}

      .card{background:var(--card);border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 1px 3px rgba(0,0,0,.04)}
      .card.pad{padding:16px}

      .grid7{display:grid;grid-template-columns:repeat(7,1fr);grid-gap:4px}
      .weekday{font-size:12px;color:var(--fg);text-align:center;font-weight:600;margin-bottom:4px}

      /* 正方形セル：padding-topトリックで端末差を排除 */
      .square{position:relative;width:100%;padding-top:100%}
      .square > .inner{position:absolute;inset:0;border-radius:12px;border:1px solid rgba(16,185,129,.35);
                       background:rgba(16,185,129,.12); color:var(--fg); display:flex;align-items:center;justify-content:center}
      .square .day{position:absolute;top:4px;left:6px;font-size:12px;opacity:.8}
      .square.today{box-shadow:0 0 0 2px var(--ring) inset}
      .square.dim{opacity:.6}

      .section{margin:24px 0}
      .hstack{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px}

      /* アニメ（最低限） */
      @keyframes spinSnap{0%{transform:rotate(0)}70%{transform:rotate(320deg)}100%{transform:rotate(360deg)}}
      .spin{animation:spinSnap 1.1s ease-out}

      /* バナー */
      .banner{position:fixed;top:64px;left:50%;transform:translateX(-50%);
              z-index:30;background:#fff7ed; border:1px solid #fed7aa; color:#7c2d12;
              padding:8px 12px;border-radius:14px; box-shadow:0 10px 20px rgba(0,0,0,.06)}
    </style>
  </head>
  <body>
    <div id="root">
      <div id="loading-text">スタンプカード React版 読み込み中…</div>
    </div>

    <!-- JSX（Babelがその場変換） -->
    <script type="text/babel" data-presets="env,react" src="./bundle.js"></script>

    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js', { scope: './' }).catch(console.warn);
      }
    </script>
  </body>
</html>
